APP=function(a,b){var c=function(){d(),$(".dashboard-index").length&&e(),f(),g(),h()},d=function(){$(b).on("click",".status-btn-container a",function(){var a=$(this).attr("data-status");return $(".status-btn-container a").removeClass("active"),$(this).addClass("active"),""===a?($(".orderlist-order a").removeClass("none"),$(".total-list").text($(".orderlist-order a").length)):($(".orderlist-order a").addClass("none"),$('.orderlist-order a[data-status="'+a+'"]').removeClass("none"),$(".total-list").text($('.orderlist-order a[data-status="'+a+'"]').length)),!1})},e=function(){$.ajax({url:"/api/orders",method:"GET",dataType:"json"}).done(function(a){var b=a.data;_.forEach(b,function(a,b){$(".orderlist-order").append('<a href="#" data-oid="'+a._id+'" data-status="'+a.status+'">#<span class="txt-uc">'+a.orderId+'</span><span class="total">'+a.totalItem+" items</span></a>")}),$('.status-btn-container a[data-status="1"]').trigger("click")}).fail(function(a){console.log(a)})},f=function(){$(b).on("click",".orderlist-order a",function(){var a=$(this).attr("data-oid");return $(".product-ordered--list tbody").empty(),$(".product-ordered--total-coupon").text(0),$(".product-ordered--total-percentage").text(""),$(".product-ordered--total-subtotal").text(0),$(".orderlist").addClass("none"),$(".shipping").removeClass("none"),$.ajax({url:"/api/orders/"+a,method:"GET",dataType:"json"}).done(function(a){var b=a.data;$(".orderid").text(b.order.orderId),$(".shipping-name").text(b.order.name),$(".shipping-phone").text(b.order.phone),$(".shipping-email").text(b.order.email),$(".shipping-address").text(b.order.address),$(".shipping-oid").val(b.order._id),$(".shipping-code").val(b.order.shippingCode),_.forEach(b.orderItem,function(a,b){$(".product-ordered--list tbody").append('<tr><td><div class="product-ordered--image" style="background-image: url('+a.product.image+')"></div></td><td><p class="product-ordered--desc">'+a.product.name+'</p></td><td><p class="product-ordered--count"><span class="product-ordered--count-text">'+a.count+'</span></p></td><td><p class="product-ordered--price">Rp <span class="product-ordered--price-text">'+GENERAL.currency(a.price*a.count)+"</span></p></td></tr>")});var c=0;if($(".product-ordered--price-text").each(function(a,b){var d=$(b).text().replace(/,/g,"");c+=parseInt(d)}),$(".product-ordered--total-subtotal").text(GENERAL.currency(c)),b.order.coupon){var d=c*(b.order.coupon.percentage/100);$(".product-ordered--total-coupon").text(GENERAL.currency(d)),$(".product-ordered--total-percentage").text(["-",b.order.coupon.percentage,"%"].join(""))}else console.log("gak ada kupon"),$(".product-ordered--total-coupon").text(0),$(".product-ordered--total-percentage").text("");var e=c+parseInt($(".product-ordered--total-shipping").text().replace(/,/g,""))-d||0;$(".product-ordered--total-final").text(GENERAL.currency(e)),$("html, body").animate({scrollTop:0},"fast")}).fail(function(a){console.log(a)}),!1})},g=function(){$(b).on("click",".back-btn",function(){return $(".orderlist").removeClass("none"),$(".shipping").addClass("none"),$("html, body").animate({scrollTop:0},"fast"),!1})},h=function(){$(b).on("submit",".shipping-form",function(a){a.preventDefault();var b=$(this),c=b.attr("action"),d={shippingCode:b.find('input[name="shippingCode"]').val(),oid:b.find('input[name="oid"]').val()};return validator.isNull(d.shippingCode)?(GENERAL.notifier("Shipping code can't be empty","error"),GENERAL.resetBtn(b,"Submit")):$.ajax({url:c,method:"POST",dataType:"json",data:d}).done(function(a){var c=a.data;console.log(c),$('.orderlist-order a[data-oid="'+c._id+'"]').attr("data-status","2"),$('.status-btn-container a[data-status="1"]').trigger("click"),GENERAL.notifier("Shipping code has been submitted successfully","success"),$(".back-btn").trigger("click"),GENERAL.resetBtn(b,"Submit")}).fail(function(a){console.log(a),GENERAL.resetBtn(b,"Submit")}),!1})};return{init:c}}(window,document),$(function(){APP.init()}),GENERAL=function(a,b){var c=function(){d(),e(),f(),k()},d=function(a,b){$(".ajax-messages").hide(),$("."+b+"-msg-ajax").show(),$("."+b+"-msg-ajax p").text(a),setTimeout(function(){$("."+b+"-msg-ajax").fadeOut(500)},5e3)},e=function(){$(".render-messages").length&&setTimeout(function(){$(".render-messages").fadeOut(500)},3e3)},f=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},g=function(b,c){c||(c=a.location.href),b=b.replace(/[\[\]]/g,"\\$&");var d=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),e=d.exec(c);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null},h=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},i=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},j=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),k=function(){$(b).on("keyup focus","input.phone-validator",function(){var a=$(this),b=$(this).val();j(function(){"+62"!==b.substring(0,3)&&(a.prop("required")?a.val("+62"):""!==b&&a.val("+62"))},500)})},l=function(a,b){a.find("button").prop("disabled",!1),a.find("button").text(b)};return{init:c,notifier:d,getUuid:f,getParameterByName:g,capitalize:h,delay:j,currency:i,resetBtn:l}}(window,document),$(function(){GENERAL.init()});